# User Flow (Діаграма навігації користувача)

## Система: SafeHeight Monitor

User Flow - це візуалізація шляхів користувача через систему, яка показує послідовність екранів, точки прийняття рішень та можливі переходи між різними частинами додатку.

---

## Діаграми User Flow

### 1. Повна діаграма User Flow
**Файл:** `user_flow_diagram.puml`

**Опис:** Детальна діаграма потоків користувачів для всіх ролей з точками прийняття рішень

**Типі діаграми:** PlantUML Activity Diagram

**Охоплює:**
- Процес автентифікації для всіх 5 ролей
- Потік роботи працівника з IoT пристроєм
- Робочий процес інженера з охорони праці
- Процеси бригадира з керування зонами
- Аналітичні процеси менеджера проекту
- Адміністративні функції

**Ключові елементи:**
- **Start/End** - початок та кінець потоку
- **Activity** - дія користувача або системи
- **Decision** - точка прийняття рішення (if/else)
- **Fork/Join** - паралельні процеси
- **Note** - додаткова інформація

---

### 2. Навігаційна карта (Navigation Map)
**Файл:** `navigation_map.puml`

**Опис:** Спрощена карта переходів між екранами системи

**Тип діаграми:** PlantUML Component/Deployment Diagram

**Охоплює:**
- Всі основні екрани системи (WF-01 до WF-05)
- Додаткові екрани (деталі, налаштування, документи)
- Двосторонні та односторонні переходи
- Модальні вікна та діалоги
- Вкладки та підменю

**Елементи навігації:**
- Головні екрани (синій колір)
- Точка входу (помаранчевий)
- Критичні екрани (червоний)
- Адмін панель (фіолетовий)

---

## Основні користувацькі потоки

### Потік 1: Працівник будівельного майданчику

```
[Старт]
  → WF-01: Автентифікація (QR-код або PIN)
  → Активація IoT моніторингу
  → Реєстрація на зміну
  → [Цикл] Постійний моніторинг під час роботи
      ↓ (якщо виявлено ризик)
      → WF-03: Екран попередження
      → Реакція користувача:
         • "Я в безпеці" → Логування → Продовження роботи
         • "Потрібна допомога!" → Аварійний протокол → Сповіщення відповідальних
  → Завершення зміни
  → Вихід з системи
[Кінець]
```

**Тривалість:** 8-12 годин (робоча зміна)
**Ключові екрани:** WF-01, WF-03
**Критичні рішення:** Реакція на попередження

---

### Потік 2: Інженер з охорони праці

```
[Старт]
  → WF-01: Автентифікація (Логін/Пароль)
  → WF-02: Панель моніторингу
  → [Цикл] Робоча сесія:
      • Моніторинг всіх працівників (автооновлення кожні 5 сек)
      • Пошук/Фільтрація працівників
      • Перегляд деталей працівника
      • Зв'язок з працівниками
      • Керування IoT пристроями
      ↓ (опційні переходи)
      → WF-05: Звіти (вкладка "Звіти")
      → Налаштування системи (вкладка "Налаштування")
      → IoT пристрої (вкладка "IoT пристрої")
      ↓ (якщо отримано критичний алерт)
      → Оцінка ситуації
      → Зв'язок з працівником
      → Координація дій з бригадиром
  → Вихід з системи
[Кінець]
```

**Тривалість:** 8-12 годин (робоча зміна)
**Ключові екрани:** WF-02, WF-05
**Критичні рішення:** Реакція на алерти, оцінка ризиків

---

### Потік 3: Бригадир

```
[Старт]
  → WF-01: Автентифікація (Логін/Пароль)
  → WF-04: Керування зонами
  → [Цикл] Робоча сесія:
      • Перегляд карти зон та бригади
      • Створення/Редагування/Видалення зон
      • Призначення працівників до зон
      • Зв'язок з працівниками бригади
      • Експорт розкладу
      ↓ (опційні переходи)
      → WF-02: Панель моніторингу (вкладка "Панель")
         (бачить лише свою бригаду)
      ↓ (якщо отримано алерт)
      → Оцінка ситуації
      → Зв'язок з працівником
      → Координація з інженером з ОП
  → Вихід з системи
[Кінець]
```

**Тривалість:** 8-12 годин (робоча зміна)
**Ключові екрани:** WF-04, WF-02
**Критичні рішення:** Призначення працівників, реакція на алерти

---

### Потік 4: Менеджер проекту

```
[Старт]
  → WF-01: Автентифікація (Логін/Пароль)
  → WF-05: Аналітика та звітність
  → [Цикл] Робоча сесія:
      • Налаштування періоду звітності
      • Генерація звіту
      • Аналіз ключових метриків (KPI)
      • Перегляд графіків трендів
      • Аналіз зон з високим ризиком
      • Перегляд рекомендацій системи
      ↓ (дії з звітом)
      → Експорт PDF
      → Експорт Excel
      → Відправка email
      → Друк звіту
      → Збереження як шаблон
      → Генерація посилання для шерингу
      ↓ (опційні переходи)
      → WF-02: Панель моніторингу (вкладка "Панель")
      → Бібліотека документів (вкладка "Документи")
  → Вихід з системи
[Кінець]
```

**Тривалість:** Змінна (зазвичай 1-2 години на сесію)
**Ключові екрани:** WF-05
**Критичні рішення:** Аналіз трендів, прийняття управлінських рішень

---

### Потік 5: Системний адміністратор

```
[Старт]
  → WF-01: Автентифікація (Логін/Пароль)
  → Адміністративна панель
  → [Цикл] Адмін сесія:
      • Керування користувачами (створення/редагування/видалення)
      • Налаштування системи
      • Моніторинг серверів та сервісів
      • Перегляд логів системи
      • Резервне копіювання даних
      • Оновлення системи
      ↓ (доступ до всіх модулів)
      → WF-02: Панель моніторингу
      → WF-04: Керування зонами
      → WF-05: Аналітика та звітність
      → Налаштування системи
      → IoT пристрої
  → Вихід з системи
[Кінець]
```

**Тривалість:** Змінна
**Ключові екрани:** Адмін панель, всі модулі
**Критичні рішення:** Системні налаштування, керування доступом

---

## Точки прийняття рішень (Decision Points)

### 1. Автентифікація

**Рішення:** Вибір методу автентифікації
- **QR-код** → Швидкий вхід (для працівників)
- **PIN-код** → Альтернативний метод (для працівників)
- **Логін/Пароль** → Стандартний вхід (для адміністративних ролей)

**Наслідки:**
- Успішна автентифікація → Перехід до відповідного екрану
- Невдала автентифікація → Показати помилку, залишитися на WF-01

---

### 2. Виявлення ризику (AI аналіз)

**Рішення:** Рівень виявленого ризику
- **Критичний (>80%)** → WF-03 з червоним попередженням + сповіщення всіх
- **Увага (50-80%)** → Показати попередження на пристрої + вібрація
- **Безпечно (<50%)** → Нормальний режим

**Наслідки:**
- Критичний → Негайна реакція потрібна
- Увага → Користувач попереджений
- Безпечно → Продовження роботи

---

### 3. Реакція працівника на попередження

**Рішення:** Вибір дії на WF-03
- **"Я в безпеці"** → Підтвердження отримання + логування
- **"Потрібна допомога!"** → Активація аварійного протоколу + масові сповіщення

**Наслідки:**
- Безпека підтверджена → Зняти алерт, продовжити моніторинг
- Допомога потрібна → Координація рятувальних дій

---

### 4. Призначення працівника до зони

**Рішення:** Чи має зона вільні місця?
- **Так** → Дозволити призначення
- **Ні** → Показати помилку "Зона повна"

**Наслідки:**
- Дозволено → Оновити карту, відправити сповіщення працівнику
- Заборонено → Бригадир має вибрати іншу зону або розширити поточну

---

### 5. Експорт звіту

**Рішення:** Вибір формату експорту
- **PDF** → Генерація PDF з графіками
- **Excel** → Експорт сирих даних + графіки як зображення
- **Email** → Вибір формату + відправка на вказані адреси

**Наслідки:**
- Різні формати для різних цілей (презентація vs аналіз даних)

---

## Паралельні процеси

### 1. Моніторинг працівника

**Паралельно виконуються:**
- Збір даних з сенсорів IoT (висота, GPS, акселерометр, пульс)
- AI аналіз ризиків в реальному часі
- Передача даних на сервер
- Оновлення UI на пристрої працівника
- Оновлення панелі моніторингу (WF-02) для інженера з ОП

**Синхронізація:** Кожні 1-5 секунд

---

### 2. Аварійний протокол

**Паралельно виконуються:**
- Сповіщення інженера з охорони праці
- Сповіщення бригадира
- Сповіщення центральної диспетчерської
- Логування події в базу даних
- Активація запису з камер (якщо доступно)

**Мета:** Швидка реакція всіх відповідальних осіб

---

## Автоматичні процеси

### 1. Автооновлення панелі моніторингу (WF-02)

**Інтервал:** Кожні 5 секунд

**Процес:**
1. Запит свіжих даних з сервера
2. Оновлення таблиці працівників
3. Оновлення позицій на карті
4. Оновлення статус-бару
5. Перевірка нових алертів

**Можливість:** Користувач може зупинити автооновлення та оновлювати вручну

---

### 2. AI аналіз ризиків

**Інтервал:** Постійно (кожна секунда)

**Процес:**
1. Отримання даних з сенсорів
2. Передобробка даних
3. Передача в ML модель
4. Класифікація ризику (Безпечно/Увага/Критично)
5. Генерація попередження (якщо потрібно)

**Модель:** Azure Machine Learning

---

## Технічна інформація

### Створення діаграм

**PlantUML Activity Diagram:**
- Підтримка складних потоків з розгалуженнями
- Візуалізація паралельних процесів (fork/join)
- Умовна логіка (if/else, while)
- Нотатки та коментарі

**PlantUML Component Diagram:**
- Візуалізація зв'язків між компонентами
- Спрощена навігаційна карта
- Легенда та анотації

### Генерація зображень

**Онлайн:**
```
http://www.plantuml.com/plantuml/uml/
```

**Локально:**
```bash
plantuml user_flow_diagram.puml
plantuml navigation_map.puml
```

**VS Code:**
```
Розширення: PlantUML
Попередній перегляд: Alt+D
```

---

## Підсумок

**Створено:** 2 діаграми User Flow

**Охоплення:**
- 5 основних ролей користувачів
- 5 головних екранів (WF-01 до WF-05)
- 12+ додаткових екранів та діалогів
- 15+ точок прийняття рішень
- 5+ паралельних процесів
- 2+ автоматичних процесів

**Користувацькі потоки:**
- Працівник: Автентифікація → IoT моніторинг → Реакція на алерти
- Інженер з ОП: Панель моніторингу → Фільтрація → Зв'язок → Звіти
- Бригадир: Керування зонами → Призначення → Моніторинг бригади
- Менеджер: Аналітика → Генерація звітів → Експорт → Рекомендації
- Адміністратор: Адмін панель → Всі модулі системи

**Типи переходів:**
- Односторонні (вперед)
- Двосторонні (туди-назад)
- Модальні (діалоги)
- Вкладки (в межах одного екрану)

---

*Лабораторна робота №5, User Flow (Діаграма навігації)*
