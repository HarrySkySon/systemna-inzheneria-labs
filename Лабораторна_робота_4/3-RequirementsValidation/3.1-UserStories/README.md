# Користувацькі історії (User Stories) та Критерії приймального тестування

## Система: SafeHeight Monitor

---

## Epic 1: Реєстрація та автентифікація працівників

### US1.1: Реєстрація працівника на початку зміни через QR-код

**User Story:**
```
As a Працівник будівельного майданчику
I want to швидко зареєструватися в системі на початку зміни через QR-код
So that я можу розпочати роботу під моніторингом системи безпеки
```

**Acceptance Criteria (AC1.1):**

```gherkin
Feature: Реєстрація працівника через QR-код

  Scenario: Успішна реєстрація працівника через сканування QR-коду
    Given працівник має виданий IoT пристрій
    And працівник має дійсний обліковий запис в системі
    And система SafeHeight Monitor активна
    When працівник сканує QR-код на вході на майданчик
    Then система автоматично ідентифікує працівника
    And система перевіряє медичний допуск та сертифікати
    And система активує моніторинг положення та стану працівника
    And працівник отримує підтвердження через звуковий сигнал та вібрацію
    And статус працівника змінюється на 'Активний' в панелі моніторингу
    And час реєстрації не перевищує 15 секунд

  Scenario: Реєстрація при прострочен ому медичному допуску
    Given працівник має виданий IoT пристрій
    And медичний допуск працівника прострочений
    When працівник сканує QR-код на вході
    Then система відхиляє реєстрацію
    And система сповіщає інженера з охорони праці
    And працівник отримує повідомлення про неможливість розпочати роботу
```

### US1.2: Автентифікація працівника через PIN-код

**User Story:**
```
As a Працівник будівельного майданчику
I want to мати можливість увійти в систему через PIN-код якщо QR-код не працює
So that я можу розпочати роботу навіть при технічних проблемах з QR-сканером
```

**Acceptance Criteria (AC1.2):**

```gherkin
Feature: Автентифікація через PIN-код

  Scenario: Успішна автентифікація через PIN-код
    Given QR-сканер не працює або недоступний
    And працівник має дійсний PIN-код
    When працівник вибирає опцію "Ввести PIN-код"
    And працівник вводить правильний 6-значний PIN-код
    Then система ідентифікує працівника
    And система активує моніторинг
    And час автентифікації не перевищує 3 секунди

  Scenario: Блокування після 3 невірних спроб
    Given працівник вводить невірний PIN-код
    When кількість невірних спроб досягає 3
    Then система блокує обліковий запис працівника
    And система надсилає сповіщення службі безпеки
```

---

## Epic 2: Моніторинг працівників в реальному часі

### US2.1: Перегляд поточного статусу всіх працівників

**User Story:**
```
As an Інженер з охорони праці
I want to бачити статус всіх працівників на майданчику в реальному часі
So that я можу оперативно реагувати на небезпечні ситуації
```

**Acceptance Criteria (AC2.1):**

```gherkin
Feature: Панель моніторингу працівників

  Scenario: Відображення статусу всіх активних працівників
    Given інженер автентифікований в системі
    And на майданчику є активні працівники
    When інженер відкриває панель моніторингу
    Then система відображає список всіх активних працівників
    And для кожного працівника показано: ім'я, статус, локацію, час останнього оновлення, рівень ризику
    And карта майданчику показує розташування працівників
    And дані оновлюються автоматично кожні 5 секунд
    And панель завантажується не довше 5 секунд

  Scenario: Виділення працівників з критичним статусом
    Given на панелі моніторингу є працівники
    And деякі працівники мають критичний статус
    When система оновлює дані
    Then працівники з критичним статусом виділяються червоним кольором
    And вони переміщуються на верх списку
    And лунає звукове сповіщення
```

### US2.2: Фільтрація працівників за статусом

**User Story:**
```
As an Інженер з охорони праці
I want to фільтрувати працівників за рівнем ризику
So that я можу швидко знайти тих, хто потребує уваги
```

**Acceptance Criteria (AC2.2):**

```gherkin
Feature: Фільтрація працівників

  Scenario: Фільтрація працівників за статусом безпеки
    Given інженер переглядає панель моніторингу
    And на майданчику працюють 50 працівників
    When інженер вибирає фільтр "Критично"
    Then система показує тільки працівників зі статусом "Критично"
    And фільтрація виконується не більше ніж за 2 кліки
    And результат відображається миттєво (менше 1 секунди)
```

---

## Epic 3: Виявлення ризиків та сповіщення

### US3.1: Отримання попередження про ризик падіння

**User Story:**
```
As a Працівник будівельного майданчику
I want to отримувати миттєві попередження при виявленні ризику падіння
So that я можу вчасно вжити заходів безпеки та уникнути травми
```

**Acceptance Criteria (AC3.1):**

```gherkin
Feature: Попередження про ризик падіння

  Scenario: Виявлення та сповіщення про підвищений ризик
    Given працівник зареєстрований в системі
    And IoT пристрій активний та передає дані
    And AI модель виявлення ризиків функціонує
    When IoT датчики фіксують небезпечне положення (ймовірність ризику 75%)
    Then AI модель аналізує дані за 1 секунду
    And система генерує попередження рівня 'Увага'
    And працівник отримує аудіо та вібро сигнал протягом 2 секунд
    And на дисплеї IoT пристрою відображається повідомлення
    And інженер з охорони праці отримує сповіщення в панелі моніторингу

  Scenario: Критичний ризик з активацією аварійного протоколу
    Given працівник зареєстрований в системі
    When AI модель виявляє критичний ризик (ймовірність >90%)
    Then система генерує попередження рівня 'Критично'
    And працівник отримує інтенсивний аудіо та вібро сигнал
    And сповіщення дублюється через SMS бригадиру
    And активується аварійний протокол
    And точність виявлення ризику становить мінімум 95%

  Scenario: Відсутність реакції працівника на критичне попередження
    Given працівник отримав критичне попередження
    When працівник не підтверджує отримання протягом 10 секунд
    Then система підвищує рівень тривоги
    And сповіщаються інженер з охорони праці та бригадир
    And ініціюється перевірка стану працівника
    And система логує інцидент з timestamp
```

### US3.2: Моніторинг точності AI моделі

**User Story:**
```
As an Інженер з охорони праці
I want to бачити статистику точності AI моделі виявлення ризиків
So that я можу оцінити надійність системи та налаштувати пороги
```

**Acceptance Criteria (AC3.2):**

```gherkin
Feature: Статистика точності AI моделі

  Scenario: Перегляд статистики хибних спрацювань
    Given інженер має доступ до аналітики системи
    When інженер переглядає звіт за останній місяць
    Then система показує кількість true positives, false positives, false negatives
    And рівень хибних спрацювань не перевищує 5%
    And загальна точність моделі становить мінімум 95%
```

---

## Epic 4: Керування робочими зонами

### US4.1: Призначення робочих зон бригаді

**User Story:**
```
As a Бригадир
I want to призначати робочі зони для моєї бригади
So that система могла контролювати, що працівники не виходять за межі безпечної зони
```

**Acceptance Criteria (AC4.1):**

```gherkin
Feature: Призначення робочих зон

  Scenario: Створення нової робочої зони для бригади
    Given бригадир автентифікований в системі
    And бригадир вибрав працівників для призначення
    When бригадир малює зону на карті майданчику
    And бригадир зберігає зону з назвою "Зона A - 3 поверх"
    Then система створює робочу зону
    And межі зони відображаються на карті
    And всі працівники бригади отримують сповіщення про призначення

  Scenario: Сповіщення при виході за межі зони
    Given працівник призначений до робочої зони "Зона A"
    When GPS датчик фіксує положення працівника за межами зони
    Then система надсилає попередження працівникові
    And бригадир отримує сповіщення про порушення
```

---

## Epic 5: Налаштування правил безпеки

### US5.1: Налаштування порогових значень виявлення ризиків

**User Story:**
```
As an Інженер з охорони праці
I want to налаштовувати порогові значення для різних типів ризиків
So that система враховувала специфіку робіт на різних ділянках майданчику
```

**Acceptance Criteria (AC5.1):**

```gherkin
Feature: Налаштування порогів виявлення ризиків

  Scenario: Зміна порогового значення висоти для критичного ризику
    Given інженер має права на налаштування системи
    And поточний поріг критичної висоти = 10 метрів
    When інженер змінює поріг на 15 метрів
    And інженер зберігає налаштування
    Then система застосовує нові налаштування протягом 10 секунд
    And всі працівники на висоті 10-15м більше не отримують критичні сповіщення
    And система логує зміну налаштувань з timestamp та ім'ям інженера
```

---

## Epic 6: Керування IoT пристроями

### US6.1: Моніторинг стану IoT пристроїв

**User Story:**
```
As a Системний адміністратор
I want to бачити статус всіх IoT пристроїв в системі
So that я можу оперативно виявляти та усувати несправності
```

**Acceptance Criteria (AC6.1):**

```gherkin
Feature: Панель керування IoT пристроями

  Scenario: Відображення статусу всіх IoT пристроїв
    Given адміністратор автентифікований в системі
    And в системі зареєстровано 150 IoT пристроїв
    When адміністратор відкриває панель IoT пристроїв
    Then система показує список всіх пристроїв
    And для кожного пристрою відображається: ID, статус (активний/офлайн/несправний), рівень заряду, останнє з'єднання
    And пристрої з низьким зарядом (<20%) виділяються жовтим
    And несправні пристрої виділяються червоним

  Scenario: Сповіщення про низький рівень заряду пристрою
    Given IoT пристрій працює
    When рівень заряду падає нижче 20%
    Then система надсилає сповіщення адміністратору
    And працівник отримує попередження на пристрої
    And час виявлення проблеми не перевищує 30 секунд
```

### US6.2: Віддалена діагностика IoT пристрою

**User Story:**
```
As a Системний адміністратор
I want to мати можливість віддалено діагностувати та перезавантажити IoT пристрій
So that я можу вирішувати проблеми без фізичного доступу до пристрою
```

**Acceptance Criteria (AC6.2):**

```gherkin
Feature: Віддалена діагностика IoT пристроїв

  Scenario: Віддалене перезавантаження пристрою
    Given адміністратор вибрав пристрій зі статусом "несправний"
    When адміністратор натискає кнопку "Перезавантажити"
    Then система надсилає команду перезавантаження
    And пристрій перезавантажується протягом 30 секунд
    And після перезавантаження статус змінюється на "активний"

  Scenario: Діагностика з генерацією звіту
    Given адміністратор вибрав пристрій
    When адміністратор запускає діагностику
    Then система збирає дані про пристрій (версія ПЗ, стан датчиків, історія помилок)
    And діагностика завершується за 2 хвилини
    And система генерує звіт з результатами
```

---

## Epic 7: Керування користувачами

### US7.1: Створення облікового запису працівника

**User Story:**
```
As a Системний адміністратор
I want to створювати облікові записи для нових працівників
So that вони могли використовувати систему моніторингу
```

**Acceptance Criteria (AC7.1):**

```gherkin
Feature: Створення облікових записів

  Scenario: Успішне створення облікового запису нового працівника
    Given адміністратор автентифікований в системі
    When адміністратор заповнює форму з даними: ПІБ, посада, номер телефону, дата медичного допуску
    And адміністратор призначає роль "Працівник"
    And адміністратор генерує PIN-код
    Then система створює обліковий запис
    And працівник отримує SMS з PIN-кодом
    And обліковий запис з'являється в списку користувачів

  Scenario: Валідація даних при створенні облікового запису
    Given адміністратор заповнює форму створення користувача
    When адміністратор вводить некоректний номер телефону
    Then система показує помилку валідації
    And обліковий запис не створюється
```

---

## Epic 8: Звітність та аналітика

### US8.1: Генерація звіту з безпеки за період

**User Story:**
```
As a Менеджер проекту
I want to генерувати звіти з безпеки за вибраний період
So that я можу аналізувати інциденти та покращувати умови праці
```

**Acceptance Criteria (AC8.1):**

```gherkin
Feature: Генерація звітів з безпеки

  Scenario: Генерація місячного звіту з безпеки
    Given менеджер автентифікований в системі
    And в системі є дані за останні 30 днів
    When менеджер вибирає період "останній місяць"
    And менеджер натискає "Генерувати звіт"
    Then система збирає статистику: кількість попереджень, інциденти, топ-5 зон з найбільшим ризиком
    And звіт генерується не довше 10 секунд
    And звіт включає графіки та діаграми

  Scenario: Експорт звіту в PDF
    Given звіт згенеровано
    When менеджер натискає "Експорт в PDF"
    Then система створює PDF файл
    And PDF відповідає стандарту ISO 32000
    And менеджер може завантажити файл одним кліком
```

### US8.2: Аналіз трендів аварійності

**User Story:**
```
As a Менеджер проекту
I want to бачити тренди аварійності на майданчику
So that я можу приймати превентивні заходи для покращення безпеки
```

**Acceptance Criteria (AC8.2):**

```gherkin
Feature: Аналіз трендів аварійності

  Scenario: Відображення графіку трендів попереджень
    Given менеджер переглядає аналітику
    And в системі є дані за 3 місяці
    When менеджер вибирає "Тренди попереджень"
    Then система відображає лінійний графік кількості попереджень по днях
    And графік показує окремі лінії для рівнів "Увага" та "Критично"
    And графік інтерактивний (можна наводити курсор для деталей)

  Scenario: Виявлення аномалій в трендах
    Given система аналізує дані за місяць
    When кількість попереджень за день перевищує середнє значення в 2 рази
    Then система виділяє цей день як аномалію
    And менеджер отримує сповіщення про аномалію
```

---

## Epic 9: Офлайн режим та синхронізація

### US9.1: Робота IoT пристрою в офлайн режимі

**User Story:**
```
As a Працівник будівельного майданчику
I want to щоб IoT пристрій продовжував моніторинг навіть при втраті зв'язку
So that моя безпека була забезпечена незалежно від якості мережі
```

**Acceptance Criteria (AC9.1):**

```gherkin
Feature: Офлайн режим IoT пристрою

  Scenario: Продовження моніторингу при втраті зв'язку
    Given IoT пристрій активний та моніторить працівника
    When з'єднання з сервером втрачається
    Then пристрій продовжує збирати дані локально
    And пристрій зберігає мінімум 8 годин даних (288,000 записів)
    And пристрій генерує локальні попередження при виявленні ризиків
    And працівник отримує попередження на пристрої

  Scenario: Автоматична синхронізація після відновлення зв'язку
    Given IoT пристрій працював в офлайн режимі 2 години
    When з'єднання з сервером відновлюється
    Then пристрій автоматично синхронізує всі локальні дані
    And синхронізація відбувається без втрат даних
    And дані з'являються в панелі моніторингу
```

---

## Підсумок

**Всього створено:**
- 9 Епіків (Epic 1-9)
- 15 User Stories (US1.1-US9.1)
- 23 Acceptance Criteria на мові Gherkin

**Охоплення функціональних вимог:**
- FR1 (Реєстрація та автентифікація): US1.1, US1.2
- FR2 (Моніторинг в реальному часі): US2.1, US2.2
- FR3 (Виявлення ризиків): US3.1, US3.2
- FR4 (Робочі зони): US4.1
- FR5 (Налаштування правил): US5.1
- FR6 (IoT пристрої): US6.1, US6.2
- FR7 (Користувачі): US7.1
- FR8 (Звітність): US8.1, US8.2
- FR10 (Офлайн режим): US9.1

---

*Лабораторна робота №4, User Stories з Acceptance Criteria*
